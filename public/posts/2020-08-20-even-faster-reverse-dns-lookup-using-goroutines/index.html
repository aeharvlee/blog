<!DOCTYPE html>


<html lang="ko-kr" data-theme="">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>Reverse DNS Lookup Concurrently with Go - Road to Architect</title>
<meta name="description" content="">

<link rel="icon" type="image/x-icon" href="aeharvlee.github.io/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="aeharvlee.github.io/favicon.png">



    





    
    
    

    
        <link rel="stylesheet" href="/aeharvlee.github.io/css/style.6155b6d8eded05b985178f56a637943b3e7fcfccc913d9c656bbebce7c91cc6b.css" integrity="sha256-YVW22O3tBbmFF49WpjeUOz5/z8zJE9nGVrvrznyRzGs=">
    





    





    
        <link rel="stylesheet" href="aeharvlee.github.io/css/my.css?rnd=1625295603">
    




    





    
        <script src="aeharvlee.github.io/js/main.js?rnd=1625295603" type="text/javascript" charset="utf-8"></script>
    


<meta property="og:title" content="Reverse DNS Lookup Concurrently with Go" />
<meta property="og:description" content="Go Routineì„ í™œìš©í•˜ì—¬ ëŒ€ëŸ‰ì˜ ì•„ì´í”¼ì— ëŒ€í•´ Reverse DNS Lookupì„ íš¨ê³¼ì ìœ¼ë¡œ ì²˜ë¦¬í•œ ì‚¬ë¡€ë¥¼ ê³µìœ ë“œë¦½ë‹ˆë‹¤.
Image Source: https://en.wikipedia.org/wiki/Gopher
Verify Good Bot ìì„¸í•œ ìš”êµ¬ì‚¬í•­ì„ ë§ì”€ë“œë¦¬ê¸´ ì–´ë µì§€ë§Œ, ë³´ìœ í•˜ê³  ìˆëŠ” ëŒ€ëŸ‰ì˜ ì•„ì´í”¼ ì£¼ì†Œì— ëŒ€í•´ ê° ì•„ì´í”¼ê°€ Good Bot(êµ¬ê¸€ ë´‡, ì• í”Œ ë´‡, ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ë´‡ ë“±)ì¸ì§€ë¥¼ í™•ì¸í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤. ê·¸ê²ƒë„ ë¹ ë¥´ê²Œ..! ğŸ‡ ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤.
Good Botì¸ì§€ë¥¼ ê²€ì¦í•˜ëŠ” ì‘ì—…ì€ ìƒê°ë³´ë‹¤ ì‹¬í”Œí•œë°ìš”, í•´ë‹¹ ì•„ì´í”¼ ì£¼ì†Œì— ëŒ€í•´ reverse DNS lookupì„ í•´ì£¼ë©´ ë©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì•Œë ¤ì ¸ ìˆëŠ” ë´‡ë“¤ì€ DNSì— ìì‹ ì˜ ì •ë³´ë¥¼ ë“±ë¡í•´ë‘ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤." />
<meta property="og:type" content="article" />
<meta property="og:url" content="aeharvlee.github.io/posts/2020-08-20-even-faster-reverse-dns-lookup-using-goroutines/" /><meta property="og:image" content="aeharvlee.github.io/images/og-featured.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-20T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2020-08-20T00:00:00&#43;00:00" />


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="aeharvlee.github.io/images/og-featured.png"/>

<meta name="twitter:title" content="Reverse DNS Lookup Concurrently with Go"/>
<meta name="twitter:description" content="Go Routineì„ í™œìš©í•˜ì—¬ ëŒ€ëŸ‰ì˜ ì•„ì´í”¼ì— ëŒ€í•´ Reverse DNS Lookupì„ íš¨ê³¼ì ìœ¼ë¡œ ì²˜ë¦¬í•œ ì‚¬ë¡€ë¥¼ ê³µìœ ë“œë¦½ë‹ˆë‹¤.
Image Source: https://en.wikipedia.org/wiki/Gopher
Verify Good Bot ìì„¸í•œ ìš”êµ¬ì‚¬í•­ì„ ë§ì”€ë“œë¦¬ê¸´ ì–´ë µì§€ë§Œ, ë³´ìœ í•˜ê³  ìˆëŠ” ëŒ€ëŸ‰ì˜ ì•„ì´í”¼ ì£¼ì†Œì— ëŒ€í•´ ê° ì•„ì´í”¼ê°€ Good Bot(êµ¬ê¸€ ë´‡, ì• í”Œ ë´‡, ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ë´‡ ë“±)ì¸ì§€ë¥¼ í™•ì¸í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤. ê·¸ê²ƒë„ ë¹ ë¥´ê²Œ..! ğŸ‡ ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤.
Good Botì¸ì§€ë¥¼ ê²€ì¦í•˜ëŠ” ì‘ì—…ì€ ìƒê°ë³´ë‹¤ ì‹¬í”Œí•œë°ìš”, í•´ë‹¹ ì•„ì´í”¼ ì£¼ì†Œì— ëŒ€í•´ reverse DNS lookupì„ í•´ì£¼ë©´ ë©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì•Œë ¤ì ¸ ìˆëŠ” ë´‡ë“¤ì€ DNSì— ìì‹ ì˜ ì •ë³´ë¥¼ ë“±ë¡í•´ë‘ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤."/>









    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header"> 
            
                <h1 class="site-title">
    <a href="/aeharvlee.github.io">Road to Architect</a>
</h1>

    <nav>
        
        
        <a class="" href="aeharvlee.github.io/aeharvlee.github.io/posts/" title="Archive">Archive</a>
        
    </nav>


            
        </header>
        <main id="main" tabindex="-1"> 
            
    
    
    <article class="post">
        <header class="post-header">
            <h1 class="post-title">Reverse DNS Lookup Concurrently with Go</h1>
        </header>
        <aside>
            <nav id="TableOfContents">
  <ol>
    <li><a href="#verify-good-bot">Verify Good Bot</a></li>
    <li><a href="#linear-reverse-dns-lookup--">Linear Reverse DNS Lookup  ğŸ˜«</a></li>
    <li><a href="#reverse-dns-lookup-with-goroutine-">Reverse DNS Lookup with Goroutine ğŸ˜¸</a></li>
    <li><a href="#more">More?</a></li>
  </ol>
</nav>
        </aside>
        <div class="content">
            <p>Go Routineì„ í™œìš©í•˜ì—¬ ëŒ€ëŸ‰ì˜ ì•„ì´í”¼ì— ëŒ€í•´ Reverse DNS Lookupì„ íš¨ê³¼ì ìœ¼ë¡œ ì²˜ë¦¬í•œ ì‚¬ë¡€ë¥¼ ê³µìœ ë“œë¦½ë‹ˆë‹¤.</p>
<p><img src="/images/2020-08-20-even-faster-reverse-dns-lookup-using-goroutines/0.png" alt="gopher"></p>
<p>Image Source: <a href="https://en.wikipedia.org/wiki/Gopher">https://en.wikipedia.org/wiki/Gopher</a></p>
<h2 id="verify-good-bot">Verify Good Bot</h2>
<p>ìì„¸í•œ ìš”êµ¬ì‚¬í•­ì„ ë§ì”€ë“œë¦¬ê¸´ ì–´ë µì§€ë§Œ, ë³´ìœ í•˜ê³  ìˆëŠ” <strong>ëŒ€ëŸ‰ì˜ ì•„ì´í”¼ ì£¼ì†Œì— ëŒ€í•´ ê° ì•„ì´í”¼ê°€ Good Bot</strong>(êµ¬ê¸€ ë´‡, ì• í”Œ ë´‡, ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ë´‡ ë“±)<strong>ì¸ì§€ë¥¼ í™•ì¸í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤.</strong> ê·¸ê²ƒë„ ë¹ ë¥´ê²Œ..! ğŸ‡ ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤.</p>
<p>Good Botì¸ì§€ë¥¼ ê²€ì¦í•˜ëŠ” ì‘ì—…ì€ ìƒê°ë³´ë‹¤ ì‹¬í”Œí•œë°ìš”, í•´ë‹¹ ì•„ì´í”¼ ì£¼ì†Œì— ëŒ€í•´ <strong>reverse DNS lookup</strong>ì„ í•´ì£¼ë©´ ë©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì•Œë ¤ì ¸ ìˆëŠ” ë´‡ë“¤ì€ <!-- raw HTML omitted -->DNSì— ìì‹ ì˜ ì •ë³´ë¥¼ ë“±ë¡í•´ë‘ê¸° ë•Œë¬¸<!-- raw HTML omitted -->ì…ë‹ˆë‹¤. êµ¬ê¸€ì—ì„œ ì´ì— ëŒ€í•´ ì‘ì„±í•œ <a href="https://support.google.com/webmasters/answer/80553?hl=en">Verifying Googlebot</a> ê°€ì´ë“œê°€ ìˆì–´ìš”! ğŸ˜‰</p>
<p>ì˜¤ì¼€ì´! ê·¸ë ‡ë‹¤ë©´ í•´ì•¼í•˜ëŠ” ì‘ì—…ì€ ì‹¬í”Œí•˜ë„¤ìš”. <strong>ê° ì•„ì´í”¼ì— ëŒ€í•´ Reverse DNS Lookup</strong>ì„ í•˜ë©´ ë©ë‹ˆë‹¤. âœ… Goì–¸ì–´ë¡œ í•´ë‹¹ ì‘ì—…ë‚´ìš©ì„ ì–´ë–»ê²Œ ì‘ì„±í–ˆëŠ”ì§€ ì§€ê¸ˆë¶€í„° ê°™ì´ ë³´ì‹œê² ìŠµë‹ˆë‹¤.</p>
<h2 id="linear-reverse-dns-lookup--">Linear Reverse DNS Lookup  ğŸ˜«</h2>
<p>ê°€ì¥ ë¨¼ì € í•´ë³¸ ì‘ì—…ì€ ì„ í˜• ë£©ì—…ì…ë‹ˆë‹¤. Forë¬¸ìœ¼ë¡œ ì•„ì´í”¼ ë¦¬ìŠ¤íŠ¸ì— ëŒ€í•´ Reverse DNS Lookupì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ì£ . ì´ë ‡ê²Œ í•˜ë©´ ê³¼ì—° ìš°ë¦¬ê°€ ì›í•˜ëŠ” ì‹œê°„ ë‚´ì— ì›í•˜ëŠ” ì‘ì—…ì„ í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>
<p>ì´ë ‡ê²Œ ì„ í˜•ìœ¼ë¡œ ì²˜ë¦¬í•˜ë©´ ì²˜ë¦¬ëŠ” ë˜ì§€ë§Œ, ì›í•˜ëŠ” ì‹œê°„ ë‚´ì— ë¹ ë¥´ê²Œ ì²˜ë¦¬í•  ìˆ˜ ì—†ì—ˆìŠµë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ë‹ˆ, ê³ ì‘ 500ê°œì˜ ë£©ì—…ì„ ì²˜ë¦¬í•˜ëŠ”ë° ì•½ 33ì´ˆê°€ ê±¸ë¦½ë‹ˆë‹¤. ë¯¸ë¦¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ë³´ì—¬ë“œë¦¬ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ì²«ë²ˆì§¸ë¡œ í…ŒìŠ¤íŠ¸ ëœ í•¨ìˆ˜ê°€ <strong>TestLinearReverseDNSLookup</strong>ì´ë©°, ê·¸ ë‹¤ìŒìœ¼ë¡œëŠ” ê³ ë£¨í‹´ì„ í™œìš©í•˜ì—¬ ì²˜ë¦¬í•œ <strong>TestReverseDNSLookup</strong>ê°€ í…ŒìŠ¤íŠ¸ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<pre><code>=== RUN   TestLinearReverseDNSLookup
    TestLinearReverseDNSLookup: bot_specifier_test.go:123: Start Look up 500 addresses.
    TestLinearReverseDNSLookup: bot_specifier_test.go:134: Looked up 61 addresses.
--- PASS: TestLinearReverseDNSLookup (32.95s)
=== RUN   TestReverseDNSLookup
    TestReverseDNSLookup: bot_specifier_test.go:147: Start Look up 1000 addresses.
    TestReverseDNSLookup: bot_specifier_test.go:149: Looked up 561 addresses.
--- PASS: TestReverseDNSLookup (6.52s)
</code></pre><p>ì‚¬ìš©í•œ ë°©ë²•ì€, ì•„ë˜ì™€ ê°™ì´ Google DNS ì„œë²„ë¥¼ í†µí•´ ë£©ì—…í•˜ëŠ” Resolverë¥¼ í• ë‹¹í•˜ì—¬ ì„ í˜• ë£©ì—…ì„ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤. (ë‹¨ìˆœ ë°˜ë³µë¬¸ìœ¼ë¡œ ì²˜ë¦¬í•œ ê±°ë‹ˆê¹Œ ìì„¸í•œ ì½”ë“œëŠ” ìƒëµí•©ë‹ˆë‹¤. ğŸ˜‡)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">Resolver</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">Resolver</span>{
	<span style="color:#a6e22e">PreferGo</span>: <span style="color:#66d9ef">true</span>,
	<span style="color:#a6e22e">Dial</span>: <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">network</span>, <span style="color:#a6e22e">address</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">Conn</span>, <span style="color:#66d9ef">error</span>) {
		<span style="color:#a6e22e">d</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">Dialer</span>{
			<span style="color:#a6e22e">Timeout</span>: <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Duration</span>(<span style="color:#ae81ff">3</span>),
		}
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">DialContext</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#e6db74">&#34;udp&#34;</span>, <span style="color:#e6db74">&#34;8.8.8.8:53&#34;</span>)
	},
}
</code></pre></div><h2 id="reverse-dns-lookup-with-goroutine-">Reverse DNS Lookup with Goroutine ğŸ˜¸</h2>
<p>ì˜¤ëŠ˜ í¬ìŠ¤íŒ…ì˜ ì£¼ì¸ê³µì´ë¼ê³  í•  ìˆ˜ ìˆëŠ” ê³ ë£¨í‹´ì´ ë“±ì¥í•˜ì˜€ìŠµë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì´ Reverse DNS Lookupì„ ê³ ë£¨í‹´ìœ¼ë¡œ ì²˜ë¦¬í•˜ì˜€ê³  ì„±ëŠ¥ì€ ì„ í˜• ë£©ì—…ì„ í–ˆì„ ë•Œë³´ë‹¤ ìµœì†Œ 10ë°° ì´ìƒì€ ë¹ ë¥¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤. (í•˜ë“œì›¨ì–´ ì‚¬ì–‘ì— ë”°ë¼ ì„±ëŠ¥ì´ ë‹¬ë¼ì§€ê² ì§€ë§Œìš”.)</p>
<p>{% gist 4da4f1859c82e4632e5528d011a557bb %}</p>
<p>ìœ„ ì½”ë“œì—ì„œ ì¤‘ì ì ìœ¼ë¡œ ë´ì£¼ì…”ì•¼ í•  ë¶€ë¶„ì€ <code>bs.Resolver.LookupAddr(ctx, ipv4)</code> ë¥¼ ê°ì‹¸ê³  ìˆëŠ” go func ì…ë‹ˆë‹¤. ê° ê³ ë£¨í‹´ë“¤ì´ ë£©ì—…í•œ ê²°ê³¼ë¥¼ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•˜ëŠ” í˜•íƒœë¡œ ë˜ì–´ ìˆìœ¼ë©°, ê°ê°ì˜ ê³ ë£¨í‹´ë“¤ì´ ì„ê³„ì˜ì—­ì„ ì„œë¡œ ì¹¨ë²”í•˜ì§€ ì•Šê²Œë” Mutexë¥¼ ì‚¬ìš©í•´ì„œ ì²˜ë¦¬í•´ì£¼ëŠ” ê²ƒì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ìœ„ ì½”ë“œë¥¼ ë°”íƒ•ìœ¼ë¡œ 10ë§Œê°œ ì•„ì´í”¼ì— ëŒ€í•´ ë£©ì—…ì„ ì‹¤í–‰í•œ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. ì²˜ë¦¬í•œ ì‹œê°„ì´ 1ë¶„ì´ ì±„ ì•ˆë˜ëŠ” ê±¸ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code>=== RUN   TestSpecifyGoodBots
    TestSpecifyGoodBots: bot_specifier_test.go:161: Start Look up 100000 addresses.
    TestSpecifyGoodBots: bot_specifier_test.go:163: Looked up 17690 addresses.
    TestSpecifyGoodBots: bot_specifier_test.go:165: There are 0 Good Bots in bs.DnsBook.
--- PASS: TestSpecifyGoodBots (54.92s)
PASS
</code></pre><h2 id="more">More?</h2>
<p>10ë§Œê°œ ì•„ì´í”¼ì— ëŒ€í•´ ê³ ë£¨í‹´ìœ¼ë¡œ Reverse DNS Lookupì„ ì²˜ë¦¬í•  ë•Œì˜ ê³ ë£¨í‹´ ê°œìˆ˜ ë³€í™” ì¶”ì´, í•´ë‹¹ í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš©í•˜ëŠ” CPU, Memory ë³€í™”ëŸ‰ ë“±ì— ëŒ€í•´ ëª¨ë‹ˆí„°ë§ì„ í•´ë³´ê³  ì‹¶ìŠµë‹ˆë‹¤.</p>

        </div>

        

    


<div class="post-info">
    
        <div class="post-date">2020-08-20</div>
    
    <div class="post-taxonomies">
        
            
    </div>
</div>

    </article>

    
        
    <div class="pagination post-pagination">
        <div class="left pagination-item ">
            
                <a href="/aeharvlee.github.io/posts/2020-12-09-pubkey-authentication/">Pubkey Authentication not working</a>
            
        </div>
        <div class="right pagination-item ">
            
                <a href="/aeharvlee.github.io/posts/2020-08-11-go-concurrency-pattern/">Go Concurrecny Patterns in Go Chap4 Queueing</a>
            
        </div>
    </div>

    

    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "aeharv" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    


        </main>
        
            <footer class="common-footer">
    
    

    <div class="common-footer-bottom">
        
        <div class="copyright">
            <p>Â© Hyunwoo Lee, 2021<br>
            Powered by <a target="_blank" rel="noopener noreferrer" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" rel="noopener noreferrer" href="https://github.com/mitrichius/hugo-theme-anubis">Anubis</a>.
            </p>  
        </div> 

        

    


   
    </div>
</footer>

        
    </div>
</body>
</html>
